<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./main.css">
  <title>Stupied</title>
</head>
<body>

<div id="main-content" style="padding:0;">
  <div id="image"></div>
  <div id="comments" style="padding:0 1rem;margin-bottom:1rem;"></div>
</div>

<div id="aside-1-content">
  <h3 id="title"></h3>
  <div id="desc"></div>
</div>

<script src="./main.js"></script>
<script>
    const urlQuery = new URLSearchParams(window.location.search)
    currentImage = urlQuery.get('item')

    fetch("./main.json")
        .then((response) => response.json())
        .then((art) => {
          if(currentImage===null){
            currentImage=art[0].img
            window.location.href = "./viewer.html?item="+currentImage;
          }

          imageLink='./img/'+currentImage
          image='<a href="'+imageLink+'"><img src="'+imageLink+'" title="open image"></a>'
          document.getElementById("image").innerHTML=image

          currentIndex=getIndex(art,currentImage)
          if (currentIndex>-1){
            if(art[currentIndex].title!==undefined){
              document.getElementById("title").innerHTML=art[currentIndex].title
            }
            if(art[currentIndex].desc!==undefined){
              document.getElementById("desc").innerHTML=art[currentIndex].desc
            }
          }
    })
    
    function getIndex(json,current){
      for(i=0;i<json.length;i++){
            if(json[i].img===current){
              index=i
              return index
            }
        }
        return -1
    }
</script>
</body>
</html>